import requests
urls = {
"全世界": 3409,
"美国": 3410,
"中国": 3412,
"欧盟": 3411,
"日本": 3413,
"德国": 3414,
"英国": 3416,
"印度": 3415,
"法国": 3417,
"意大利": 3418,
"加拿大": 3420,
"韩国": 3422,
"俄罗斯": 3421,
"巴西": 3419,
"澳大利亚": 3423,
"西班牙": 3424,
"墨西哥": 3425,
"印度尼西亚": 3426,
"伊朗": 3435,
"荷兰": 3427,
"沙特阿拉伯": 3428,
"土耳其": 3429,
"瑞士": 3430,
"中国台湾": 35,
"波兰": 3431,
"瑞典": 3434,
"比利时": 3433,
"泰国": 3432,
"爱尔兰": 3442,
"阿根廷": 3437,
"挪威": 3440,
"以色列": 3441,
"奥地利": 3438,
"尼日利亚": 3436,
"南非": 3446,
"孟加拉国": 3450,
"阿联酋": 3439,
"埃及": 3449,
"丹麦": 3447,
"新加坡": 3444,
"菲律宾": 3443,
"马来西亚": 3445,
"中国香港": 33,
"越南": 3454,
"巴基斯坦": 3452,
"智利": 3451,
"哥伦比亚": 3448,
"芬兰": 3453,
"罗马尼亚": 3456,
"捷克": 3455,
"新西兰": 3461,
"葡萄牙": 3457,
"秘鲁": 3459,
"希腊": 3460,
"伊拉克": 3458,
"乌克兰": 3466,
"哈萨克斯坦": 3462,
"匈牙利": 3465,
"卡塔尔": 3463,
"阿尔及利亚": 3464,
"科威特": 3467,
"摩洛哥": 3468,
"斯洛伐克": 3470,
"埃塞俄比亚": 3473,
"肯尼亚": 3474,
"古巴": 3472,
"波多黎各": 3471,
"厄瓜多尔": 3469,
"多米尼加": 3475,
"卢森堡": 3481,
"危地马拉": 3478,
"阿曼": 3479,
"斯里兰卡": 3477,
"保加利亚": 3482,
"加纳": 3483,
"安哥拉": 3476,
"科特迪瓦": 3489,
"乌兹别克斯坦": 3490,
"白俄罗斯": 3486,
"克罗地亚": 3488,
"坦桑尼亚": 3485,
"立陶宛": 3492,
"缅甸": 3480,
"哥斯达黎加": 3487,
"巴拿马": 3484,
"土库曼斯坦": 3502,
"塞尔维亚": 3497,
"斯洛文尼亚": 3493,
"乌拉圭": 3491,
"刚果(金)": 3498,
"阿塞拜疆": 3499,
"突尼斯": 3504,
"委内瑞拉": 3619,
"约旦": 3500,
"喀麦隆": 3503,
"利比亚": 3495,
"乌干达": 3507,
"玻利维亚": 3501,
"巴拉圭": 3506,
"拉脱维亚": 3508,
"巴林": 3505,
"尼泊尔": 3510,
"爱沙尼亚": 3509,
"苏丹": 3524,
"中国澳门": 3615,
"萨尔瓦多": 3512,
"洪都拉斯": 3513,
"塞浦路斯": 3514,
"塞内加尔": 3518,
"柬埔寨": 3511,
"巴布亚新几内": 3515,
"津巴布韦": 3521,
"冰岛": 3517,
"波黑": 3522,
"特立尼达和多": 3516,
"赞比亚": 3519,
"也门": 3520,
"海地": 3553,
"阿富汗": 3523,
"布基纳法索": 3532,
"马里": 3528,
"老挝": 3526,
"格鲁吉亚": 3527,
"加蓬": 3529,
"阿尔巴尼亚": 3534,
"黎巴嫩": 3496,
"巴勒斯坦": 3531,
"贝宁": 3536,
"博茨瓦纳": 3525,
"马耳他": 3535,
"莫桑比克": 3533,
"几内亚": 3547,
"蒙古": 3539,
"尼日尔": 3543,
"马达加斯加": 3537,
"尼加拉瓜": 3545,
"文莱": 3542,
"马其顿": 3544,
"亚美尼亚": 3540,
"摩尔多瓦": 3549,
"牙买加": 3530,
"刚果(布)": 3548,
"马拉维": 3556,
"赤道几内亚": 3551,
"纳米比亚": 3546,
"乍得": 3550,
"巴哈马": 3541,
"毛里求斯": 3538,
"卢旺达": 3552,
"塔吉克斯坦": 3555,
"吉尔吉斯斯坦": 3554,
"多哥": 3568,
"毛里塔尼亚": 3557,
"马恩岛": 3558,
"圭亚那": 3570,
"索马里": 3560,
"百慕大": 3559,
"列支敦士登": 3562,
"摩纳哥": 3561,
"关岛": 3563,
"黑山": 3565,
"开曼群岛": 3566,
"南苏丹": 3620,
"斯威士兰": 3571,
"巴巴多斯": 3569,
"马尔代夫": 3564,
"斐济群岛": 3567,
"塞拉利昂": 3572,
"利比里亚": 3578,
"吉布提": 3574,
"安道尔": 3575,
"法罗群岛": 3576,
"格陵兰": 3579,
"阿鲁巴": 3624,
"布隆迪": 3580,
"苏里南": 3573,
"莱索托": 3582,
"中非": 3583,
"库拉索": 3577,
"不丹": 3581,
"厄立特里亚": 3621,
"冈比亚": 3588,
"东帝汶": 3585,
"佛得角": 3586,
"伯利兹": 3587,
"圣卢西亚": 3584,
"圣马力诺": 3591,
"所罗门群岛": 3592,
"几内亚比绍": 3593,
"安提瓜和巴布": 3590,
"科摩罗": 3598,
"塞舌尔": 3589,
"荷属圣马丁": 3597,
"北马里亚纳群": 3594,
"格林纳达": 3595,
"瓦努阿图": 3600,
"圣基茨和尼维": 3599,
"特克斯和凯科": 3596,
"圣文森特和格": 3602,
"萨摩亚": 3601,
"美属萨摩亚": 3603,
"圣多美和普林": 3606,
"多米尼克": 3604,
"汤加": 3605,
"密克罗尼西亚": 3607,
"马绍尔群岛": 3609,
"帕劳": 3608,
"基里巴斯": 3610,
"瑙鲁": 3611,
"图瓦卢": 3612,
}
Header = {
"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0",
"Accept":"*/*",
"Accept-Language":"en-US,en;q=0.5",
"Accept-Encoding":"gzip, deflate, br",
"Content-Type": "application/x-www-form-urlencoded",
"Origin": "https://m.gotohui.com",
"Referer": "3410",
"Cookie": "PHPSESSID=4bu0omvlfrd78brs7ohssn9gq6; whatsnssid=1204986429c61871; whatsnslastrefresh=1",
"Sec-Fetch-Dest": "empty",
"Sec-Fetch-Mode": "cors",
"Sec-Fetch-Site": "same-origin",
"TE": "trailers",
}
URL = 'https://m.gotohui.com/index.php?index/gdp_login/1&_=1679720389710'
def parseTable(table,country):
    data = []
    td = []
    table = table[table.rfind('查看')+18:]
    tr = table.split('</tr>')
    for i in tr:
        row = [country]
        td = i.split('</td>')
        for j in td:
            # print(j,j[j.find('<td>'):])
            row.append(tonum(j[j.find('<td>')+4:]))
        if row and row[1]:data.append(row)
    return data
def tonum(s):
    str=''
    sub ='-'
    p = '.'
    for i in s:
        if (i>='0' and i<='9'):
            str+=i
        elif i==sub:
            str+='-'
            sub = ''
        elif i==p:
            str+=i
            p=''
        else:break
    if str:
        str = float(str)
        if str%1==0:str=int(str)
    else:str=0
    return str

data = [['country','year','GDP','rate']]

for i in urls:
    print(i)
    try:
        Header["Referer"]=str(urls[i])
        res=requests.post(URL,headers=Header,data={"catid":urls[i],"nian":"0"})
        data.append(parseTable(res.text,i))
    except:break
with open('gdp.json','w') as f:
    f.write(str(data))
